language: android
android:
  components:
    - platform-tools
    - tools
    - extra
    - sys-img-armeabi-v7a-android-23

  env:
    matrix:
      - ANDROID_TARGET=android-23  ANDROID_ABI=armeabi-v7a
    global:
      # switch glibc to a memory conserving mode
      - MALLOC_ARENA_MAX=2
      # wait up to 10 minutes for adb to connect to emulator
      - ADB_INSTALL_TIMEOUT=10

  before_install:
#    - echo no | android create avd --force -n test -t $ANDROID_TARGET --abi $ANDROID_ABI
#    - emulator -avd test -no-skin -no-audio -no-window &

  before_script:
#    - android-wait-for-emulator
#    - adb shell input keyevent 82 &

  script:
#    - android list target
    - ./gradlew test
